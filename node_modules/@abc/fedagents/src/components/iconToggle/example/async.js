import React, {Component} from 'react'
import {IconToggle} from '../../../export'

export default class AsyncIconToggleExample extends Component {
    constructor(props) {
        super(props)

        this.state = {
            checked: false,
        }

        this.handleToggle = this.handleToggle.bind(this)
    }

    handleToggle(isChecked) {
        if (!this.asyncCall) {
            this.asyncCall = new Promise((resolve) => {
                this.asyncTimeout = setTimeout(() => resolve(isChecked), 2000)
            })
                .then(() => {
                    clearTimeout(this.asyncTimeout)
                    this.asyncCall = undefined
                    this.setState({checked: isChecked})
                }, () => {
                    clearTimeout(this.asyncTimeout)
                    this.asyncCall = undefined
                })
        }

        return this.asyncCall
    }

    render() {
        const {checked} = this.state

        return (
            <IconToggle
                checked={checked}
                onChange={this.handleToggle}
            />
        )
    }
}
