import React from 'react'
import PropTypes from 'prop-types'
import {ProgressBar, BaseText} from '@abc/protonpack'
import nth from 'lodash/nth'
import classnames from 'classnames'
import styles from './stepBar.styl'

const StepBar = ({step, titles, hideStepNumber, className, ...remain}) => {
    const totalSteps = titles.length
    const currentStep = ~~Math.min(totalSteps, Math.max(1, step))

    return (
        <div data-abc-id="stepBar" className={classnames(styles.container, className)}>
            <ProgressBar
                className={styles.progress}
                progress={currentStep / totalSteps}
                size="xs"
                barStyle="primary"
                innerRadius
                {...remain}
            />
            <BaseText  size="xl" weight="medium">
                <div className={styles.currentStep}>
                    {!hideStepNumber && <span className={styles.currentStepNumber}>{currentStep}</span> }
                    <span className={styles.currentStepTitle}>{nth(titles, currentStep - 1)}</span>
                </div>
            </BaseText>
        </div>
    )
}

StepBar.propTypes = {
    className: PropTypes.string,
    hideStepNumber: PropTypes.bool,
    step: PropTypes.number.isRequired,
    titles: PropTypes.arrayOf(
        PropTypes.oneOfType([
            PropTypes.string,
            PropTypes.node,
        ])
    ).isRequired,
}

export default StepBar
