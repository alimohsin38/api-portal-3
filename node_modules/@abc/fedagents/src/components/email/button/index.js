import React, {Component} from 'react'
import PropTypes from 'prop-types'
import {Button} from '@abc/protonpack'
import Icon from '@abc/quarkicons'
import styles from './button.styl'

export default class EmailButton extends Component {
    constructor(props) {
        super(props)

        this.getEmail = this.getEmail.bind(this)
        this.handleEmailClick = this.handleEmailClick.bind(this)
    }

    getEmail() {
        const email = (typeof this.props.displayData === 'object') ? this.props.displayData.address : this.props.displayData

        return email.toLowerCase()
    }

    handleEmailClick(e) { 
        e.preventDefault()
        window.location.assign(`mailto:${this.getEmail()}`)
    }

    render() {
        const {displayData, ...remain} = this.props
        const email = displayData && this.getEmail()

        return (
            <Button
                btnStyle="link"
                className={styles.emailButton}
                disabled={!email}
                title={email || 'none provided'}
                onClick={this.handleEmailClick}
                data-abc-id="emailButton"
                {...remain}
            >
                <span className={styles.cta}>Email</span>
                <Icon className={styles.envelope} type='envelope' />
            </Button>
        )
    }
}

EmailButton.propTypes = {
    displayData: PropTypes.oneOfType([
        PropTypes.string,
        PropTypes.object,
    ]),
}