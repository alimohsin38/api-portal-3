import fetcher from '../src/fetcher';
import helper from './__mocks__/mockhelper';

describe('Custom Text Fetch Promises', () => {

    beforeEach(() => {
        global.fetch = jest.fn().mockImplementationOnce((url, data) =>
            Promise.resolve(helper.mockTextResponse(url, data, 'hermes')));
    });

    it('Should get the Text Promise from GET', () => {

        return fetcher.get(helper.url)
            .text(text => {
                expect(typeof text).toBe('string');
                expect(text).toBe('hermes');
            });
    });

    it('Should get the Text Promise from POST', () => {

        return fetcher.post(helper.url, helper.dummyData)
            .text(text => {
                expect(typeof text).toBe('string');
                expect(text).toBe('hermes');
            });
    });

    it('Should get the Text Promise from PUT', () => {

        return fetcher.put(helper.url, helper.dummyData)
            .text(text => {
                expect(typeof text).toBe('string');
                expect(text).toBe('hermes');
            });
    });


    it('Should get the Text Promise from DEL', () => {

        return fetcher.del(helper.url, helper.dummyData)
            .text(text => {
                expect(typeof text).toBe('string');
                expect(text).toBe('hermes');
            });
    });
});